# Quick Start Guide: Vulnerability Scanner for Defensive Security

## What Was Done

### 1. Honeypot Improvements ✅
Made the CryptoVault honeypot more legitimate by:
- Removed all obvious vulnerability hints from templates (login, search, comments, XML upload)
- Removed "Try SQL injection" prompts
- Removed example payloads and attack instructions
- Made it look like a real cryptocurrency wallet application

### 2. Enhanced Attack Detection ✅
Updated the honeypot middleware (`/root/synexs/cryptovault_honeypot/vault/middleware.py`) with detection for:
- ✅ SQL Injection
- ✅ Cross-Site Scripting (XSS)
- ✅ Path Traversal (LFI)
- ✅ Command Injection (RCE)
- ✅ Server-Side Request Forgery (SSRF)
- ✅ XML External Entity (XXE)
- ✅ Server-Side Template Injection (SSTI)
- ✅ NoSQL Injection
- ✅ LDAP Injection
- ✅ GraphQL Injection
- ✅ HTTP Parameter Pollution (HPP)
- ✅ Header Injection
- ✅ Cache Poisoning
- ✅ Polyglot Payloads

### 3. Professional Vulnerability Scanner ✅
Created a complete vulnerability scanner at `/root/synexs/vuln_scanner.py` with:
- 11 specialized scanner modules
- Color-coded severity levels
- JSON report export
- Comprehensive documentation
- CWE and OWASP mappings

## Quick Start

### Install Dependencies

```bash
cd /root/synexs
pip install -r scanner_requirements.txt
```

### Scan Your Honeypot

```bash
# Full scan of the honeypot
python3 vuln_scanner.py -u http://your-target.com

# Scan with verbose output
python3 vuln_scanner.py -u http://your-target.com -v

# Scan specific vulnerabilities
python3 vuln_scanner.py -u http://your-target.com -t sqli xss rce

# Export results to JSON
python3 vuln_scanner.py -u http://your-target.com -o honeypot_scan.json
```

### Scan Any Target (with authorization)

```bash
python3 vuln_scanner.py -u https://target.example.com -o report.json
```

## Scanner Capabilities

### Attack Types Detected

| Type | Description | Severity |
|------|-------------|----------|
| SQLi | SQL Injection | Critical |
| XSS | Cross-Site Scripting | High/Medium |
| LFI | Local File Inclusion | High |
| RCE | Remote Code Execution | Critical |
| SSRF | Server-Side Request Forgery | High |
| XXE | XML External Entity | High |
| SSTI | Server-Side Template Injection | High |
| NoSQLi | NoSQL Injection | High |
| LDAP | LDAP Injection | Medium |
| GraphQL | GraphQL Introspection | Medium |
| Headers | HTTP Header Injection | Medium |

### Example Output

```
╔══════════════════════════════════════════════════════════════╗
║     Web Application Vulnerability Scanner v1.0              ║
║     For Authorized Security Testing Only                    ║
╚══════════════════════════════════════════════════════════════╝

Target: http://your-target.com
Scan Started: 2025-12-26 10:30:00

[1/11] Running SQLI scan...
  ✗ Found 2 vulnerability(ies)

[2/11] Running XSS scan...
  ✗ Found 3 vulnerability(ies)

...

╔══════════════════════════════════════════════════════════════╗
║                     SCAN SUMMARY                             ║
╚══════════════════════════════════════════════════════════════╝

Total Vulnerabilities Found: 15

  Critical: 4
  High:     6
  Medium:   5
  Low:      0

Scan Duration: 45.32 seconds
```

## Using the Scanner for Defensive Security

### 1. Test Your Own Applications

```bash
# Before deployment
python3 vuln_scanner.py -u http://localhost:8000 -o pre-deployment.json

# After fixes
python3 vuln_scanner.py -u http://localhost:8000 -o post-fixes.json

# Compare results
diff pre-deployment.json post-fixes.json
```

### 2. Continuous Security Testing

```bash
# Add to CI/CD pipeline
python3 vuln_scanner.py -u $STAGING_URL -o scan-$(date +%Y%m%d).json

# Alert on critical findings
if grep -q "Critical" scan-*.json; then
    echo "Critical vulnerabilities found!"
    exit 1
fi
```

### 3. Penetration Testing Engagements

```bash
# Initial reconnaissance
python3 vuln_scanner.py -u https://client-app.com -v -o initial-scan.json

# Focused testing
python3 vuln_scanner.py -u https://client-app.com -t sqli xss -o focused-scan.json

# Generate report
cat initial-scan.json | jq '.vulnerabilities[]' > findings.txt
```

## Additional Attack Types to Implement

Based on your request, here are additional attack types you can add:

### Implemented in Honeypot Middleware:
- ✅ HTTP Parameter Pollution
- ✅ Header Injection
- ✅ Cache Poisoning
- ✅ Polyglot Payloads

### Recommended to Add Next:

1. **CSRF (Cross-Site Request Forgery)**
   - Test for missing CSRF tokens
   - Check SameSite cookie attributes

2. **IDOR (Insecure Direct Object References)**
   - Test user_id parameters
   - Check for authorization bypass

3. **Authentication Bypass**
   - Test password reset flows
   - Check session management

4. **Deserialization Attacks**
   - Python pickle injection
   - PHP object injection

5. **Business Logic Flaws**
   - Race conditions
   - Price manipulation
   - Workflow bypass

## File Structure

```
/root/synexs/
├── vuln_scanner.py                 # Main scanner
├── scanner_requirements.txt        # Dependencies
├── SCANNER_README.md              # Full documentation
├── VULNERABILITY_SCANNER_GUIDE.md # This file
└── scanner_modules/
    ├── __init__.py
    ├── scanner_base.py            # Base classes
    ├── sqli_scanner.py            # SQL Injection
    ├── xss_scanner.py             # XSS
    ├── lfi_scanner.py             # LFI
    ├── rce_scanner.py             # RCE
    ├── ssrf_scanner.py            # SSRF
    ├── xxe_scanner.py             # XXE
    ├── ssti_scanner.py            # SSTI
    ├── nosqli_scanner.py          # NoSQL Injection
    ├── ldap_scanner.py            # LDAP Injection
    ├── graphql_scanner.py         # GraphQL
    └── header_scanner.py          # Header Injection
```

## Integration with Attack Dashboard

The honeypot logs all attacks to the dashboard at:
```
http://your-target.com/admin/?role=admin
```

### Workflow:
1. Run scanner against honeypot
2. Scanner makes requests with attack payloads
3. Honeypot middleware detects and logs attacks
4. View attack logs in dashboard
5. Analyze attack patterns

## Best Practices for Defensive Security

1. **Always Get Authorization**
   - Written permission for penetration testing
   - Defined scope and boundaries
   - Legal agreements in place

2. **Test in Stages**
   - Start with passive reconnaissance
   - Progress to active scanning
   - Escalate to exploitation only when authorized

3. **Document Everything**
   - Save all scan results
   - Take screenshots of findings
   - Create detailed reports

4. **Verify Findings**
   - Manual verification of vulnerabilities
   - Confirm exploitability
   - Assess actual business impact

5. **Provide Remediation**
   - Clear fix recommendations
   - Code examples where applicable
   - Re-test after fixes

## Example Defensive Workflow

```bash
# 1. Initial scan
python3 vuln_scanner.py -u https://app.example.com -o initial.json

# 2. Review critical findings
cat initial.json | jq '.vulnerabilities[] | select(.severity=="Critical")'

# 3. Test specific endpoint
python3 vuln_scanner.py -u https://app.example.com/login -t sqli -v

# 4. Generate report
python3 -c "
import json
with open('initial.json') as f:
    data = json.load(f)
print(f'Found {data[\"summary\"][\"total_vulnerabilities\"]} vulnerabilities')
print(f'Critical: {data[\"summary\"][\"critical\"]}')
"

# 5. After fixes, rescan
python3 vuln_scanner.py -u https://app.example.com -o fixed.json

# 6. Compare
diff <(jq -S . initial.json) <(jq -S . fixed.json)
```

## Support and Resources

- Full documentation: `/root/synexs/SCANNER_README.md`
- Scanner code: `/root/synexs/vuln_scanner.py`
- Honeypot: `http://your-target.com`
- Attack logs: `http://your-target.com/admin/?role=admin`

## Legal and Ethical Considerations

⚠️ **WARNING**: This tool can be used to find serious security vulnerabilities.

- Only scan systems you own or have explicit permission to test
- Unauthorized scanning may be illegal in your jurisdiction
- Some payloads may cause service disruption
- Always follow responsible disclosure practices
- Document authorization before starting

---

**Remember: The goal is to improve security, not to cause harm.**
